% This file gives an example% of how to call the MATLAB PLS routine% described in Abdi  H. (2010).% Abdi, H. (2010). %   Partial least square regression, %   projection on latent structure regression,%   PLS-Regression. %   Wiley Interdisciplinary Reviews: Computational Statistics, %   2, 97-106.%   (paper available from www.utdallas.edu/~herve).% The data used here come from Abdi (2010),% they are given in Tables 1 & 2, and the figures%   correspond to Figure 1.% The results are given in Tables 3 to 13.%% This Batch file calls the following subroutines %  (which should be in the active matlab path):%    PLS_jack_svds.m, %    (the following routines are used for plotting the results)%    cormat.m, plotrname.m, plotxyha.m%% Herve Abdi February 2010% herve@utdallas.edu% Usual disclaimers apply: %   these programs are provided%   "as is" without any guarantee clear%% The date hereFM = load('/home/emo4002/colossus_shared3/pons_sfmodelling/results/degreeFC/base_vs_FU_FM.mat');FM=FM.rec';agesex = readtable('/home/emo4002/colossus_shared3/pons_sfmodelling/strokepts/agesex_pts.csv')agesex=table2array(agesex);ch_degree = load('/home/emo4002/colossus_shared3/pons_sfmodelling/results/degreeFC/base_vs_FU_change_degree_allsubjects.mat');ch_degree=cell2mat(ch_degree.change_degree');sdc=load('/home/emo4002/colossus_shared3/pons_sfmodelling/results/degreeFC/sdc.mat');sdc=sdc.sdc;% Y are the dependent variables% i.e. fugl meyer scoersY = FM;Y=normalize(Y);% X are the independent variables / predictors% i.e. change in degree from S5 to S1.X1 = ch_degree;P = sum(X1);X1 = X1(:,P~=0);X=[X1 agesex];X = normalize(X);[ni,nj]=size(X);nk=size(Y,2);% nfact gives the number of factors/latent variables% to keep for the prediction of Y and for the computation% of B_pls%nfact=20;%disp(['Data read. Going for PLS regression']);   % Call the PLS routine% Leave-one-out crossvalidation; determine the optimal number of components% with -1 subject each time.for i=1:23    X(:,i)=[];[T,P,W,Wstar,U,B,C,Bpls,Bpls_star,Xhat,...          Yhat,Yjack,R2x,R2y,RESSy,PRESSy,Q2,r2y_random,rv_random,...          Yhat4Press,Yhat4Ress]=PLS_jack_svds(X,Y,nfact);      PRESS{i}=PRESSy;endpress=cell2mat(PRESS');avg=mean(press,1);sd=std(press);errorbar([1:20],avg',sd)X=[X1 agesex];X = normalize(X);nfact=3[T,P,W,Wstar,U,B,C,Bpls,Bpls_star,Xhat,...          Yhat,Yjack,R2x,R2y,RESSy,PRESSy,Q2,r2y_random,rv_random,...          Yhat4Press,Yhat4Ress]=PLS_jack_svds(X,Y,nfact);            disp(['PLS done. Going for the graphs']);      % Here we create the names for the rows and columns     %[bootstat, bootsam]=bootstrp(250, @PLS_svds_R2,X);histogram(bootstat(:,1))bootstat=bootstat';%Calculate bootstrapped CIs using bias corrected percentile method.ci = bootci(250, {@PLS_svds,X}, 'type', 'cper', 'alpha', 0.05/length(ci));ci=ci(:,2:length(ci))';sig_rois=find(ci(:,1).*ci(:,2)>0);coeffs=Bpls_star(2:270);%first value here is irrelevantsig_roi_coeffs=coeffs(sig_rois); %extract beta coefficients of only significant ROIsinputdata=zeros(268,1);% set all other ROIs to have value = 0inputdata(sig_rois)=sig_roi_coeffs;chaco_to_brainnet(inputdata); %generate .node file with size & color scaled to beta coeffs.